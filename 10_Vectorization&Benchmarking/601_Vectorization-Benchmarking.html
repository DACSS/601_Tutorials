<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<meta name="progressive" content="false" />
<meta name="allow-skip" content="false" />

<title>Tutorial 10: ADVANCED - Vectorization &amp; Benchmarking</title>


<!-- highlightjs -->
<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>

<!-- taken from https://github.com/rstudio/rmarkdown/blob/67b7f5fc779e4cfdfd0f021d3d7745b6b6e17149/inst/rmd/h/default.html#L296-L362 -->
<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>
<!-- end tabsets -->



</head>

<body>



<div class="pageContent band">
<div class="bandContent page">

<div class="topics">

<div id="section-introduction" class="section level2">
<h2><strong>Introduction</strong></h2>
<p>In the previous tutorial, you learned about using for loops to repeat an operation in each value in a series of values. In this tutorial, we will contrast for loops with an alternative technique, <em>vectorization</em>. You will learn how to vectorize functions as well as compare the time it takes to run functions in R with a technique called <em>benchmarking</em>.</p>
<p>We will learn the following R Commands:</p>
<ul>
<li><code>install.packages()</code></li>
<li><code>runif()</code></li>
<li><code>microbenchmark()</code></li>
<li><code>mean()</code></li>
<li><code>summary()</code></li>
<li><code>autoplot()</code></li>
<li><code>vector()</code></li>
<li><code>bind_rows()</code></li>
<li><code>list.files()</code></li>
<li><code>vapply()</code></li>
<li><code>sapply()</code></li>
<li><code>lapply()</code></li>
<li><code>map()</code></li>
<li><code>str()</code></li>
<li><code>map2()</code></li>
<li><code>pmap()</code></li>
</ul>
<p>And we will use the following dataset:</p>
<p>The <code>flights</code> dataset from the R package <code>nycflights13</code>, which contains all flights out of New York City in 2013.</p>
</div>
<div id="section-benchmarking" class="section level2">
<h2><strong>Benchmarking</strong></h2>
<p>Before we learn how to compare for loops to vectorization, we need to learn about <em>benchmarking</em>. Benchmarking is used to measure the amount of time it takes to perform a computation in R. There are a number of ways to do so, but we will be using the R package <code>microbenchmark</code> <a href="https://cran.r-project.org/web/packages/microbenchmark/">(link to CRAN page)</a>.</p>
<div id="section-microbenchmark" class="section level3">
<h3><code>microbenchmark</code></h3>
<p>To install <code>microbenchmark</code>, run the following code:</p>
<pre class="r"><code>install.packages(&#39;microbenchmark&#39;)</code></pre>
<p>Then to use it, load the library:</p>
<pre class="r"><code>library(microbenchmark)</code></pre>
<p>We can then use the <code>microbenchmark()</code> function to output timing results for a line of R code. Here, let’s show how to measure the time it takes to get the mean of a numeric vector.</p>
<pre class="r"><code>vec &lt;- runif(100) # randomly sample 100 values from a uniform distribution
test_results &lt;- microbenchmark(mean(vec)) # benchmarking the time it takes to get the mean of a vector</code></pre>
<p><code>microbenchmark()</code> works by running the code many times and calculating the runtime for each calculation. Each individual runtime is stored in <code>test_results</code>. Let’s take a look at them here:</p>
<pre class="r"><code>test_results</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["expr"],"name":[1],"type":["fct"],"align":["left"]},{"label":["time"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"mean(vec)","2":"148922"},{"1":"mean(vec)","2":"4544"},{"1":"mean(vec)","2":"2701"},{"1":"mean(vec)","2":"2289"},{"1":"mean(vec)","2":"2244"},{"1":"mean(vec)","2":"2299"},{"1":"mean(vec)","2":"2151"},{"1":"mean(vec)","2":"2173"},{"1":"mean(vec)","2":"2516"},{"1":"mean(vec)","2":"2164"},{"1":"mean(vec)","2":"2220"},{"1":"mean(vec)","2":"2143"},{"1":"mean(vec)","2":"2155"},{"1":"mean(vec)","2":"2417"},{"1":"mean(vec)","2":"2166"},{"1":"mean(vec)","2":"2230"},{"1":"mean(vec)","2":"2191"},{"1":"mean(vec)","2":"2343"},{"1":"mean(vec)","2":"2144"},{"1":"mean(vec)","2":"2378"},{"1":"mean(vec)","2":"2139"},{"1":"mean(vec)","2":"2229"},{"1":"mean(vec)","2":"2217"},{"1":"mean(vec)","2":"2177"},{"1":"mean(vec)","2":"2135"},{"1":"mean(vec)","2":"2133"},{"1":"mean(vec)","2":"2209"},{"1":"mean(vec)","2":"2222"},{"1":"mean(vec)","2":"2202"},{"1":"mean(vec)","2":"2157"},{"1":"mean(vec)","2":"2149"},{"1":"mean(vec)","2":"2219"},{"1":"mean(vec)","2":"2218"},{"1":"mean(vec)","2":"2249"},{"1":"mean(vec)","2":"2229"},{"1":"mean(vec)","2":"2186"},{"1":"mean(vec)","2":"2246"},{"1":"mean(vec)","2":"2167"},{"1":"mean(vec)","2":"2140"},{"1":"mean(vec)","2":"2326"},{"1":"mean(vec)","2":"2255"},{"1":"mean(vec)","2":"2164"},{"1":"mean(vec)","2":"2195"},{"1":"mean(vec)","2":"2119"},{"1":"mean(vec)","2":"2148"},{"1":"mean(vec)","2":"2234"},{"1":"mean(vec)","2":"2139"},{"1":"mean(vec)","2":"2221"},{"1":"mean(vec)","2":"2137"},{"1":"mean(vec)","2":"2241"},{"1":"mean(vec)","2":"2130"},{"1":"mean(vec)","2":"2214"},{"1":"mean(vec)","2":"2134"},{"1":"mean(vec)","2":"2142"},{"1":"mean(vec)","2":"2341"},{"1":"mean(vec)","2":"2126"},{"1":"mean(vec)","2":"2148"},{"1":"mean(vec)","2":"2151"},{"1":"mean(vec)","2":"2291"},{"1":"mean(vec)","2":"2268"},{"1":"mean(vec)","2":"2215"},{"1":"mean(vec)","2":"2137"},{"1":"mean(vec)","2":"2174"},{"1":"mean(vec)","2":"2206"},{"1":"mean(vec)","2":"2162"},{"1":"mean(vec)","2":"2221"},{"1":"mean(vec)","2":"2154"},{"1":"mean(vec)","2":"2139"},{"1":"mean(vec)","2":"2254"},{"1":"mean(vec)","2":"2173"},{"1":"mean(vec)","2":"2143"},{"1":"mean(vec)","2":"2156"},{"1":"mean(vec)","2":"2431"},{"1":"mean(vec)","2":"2131"},{"1":"mean(vec)","2":"2266"},{"1":"mean(vec)","2":"2170"},{"1":"mean(vec)","2":"2139"},{"1":"mean(vec)","2":"2394"},{"1":"mean(vec)","2":"2145"},{"1":"mean(vec)","2":"2271"},{"1":"mean(vec)","2":"2126"},{"1":"mean(vec)","2":"2318"},{"1":"mean(vec)","2":"2289"},{"1":"mean(vec)","2":"2225"},{"1":"mean(vec)","2":"2121"},{"1":"mean(vec)","2":"2149"},{"1":"mean(vec)","2":"2315"},{"1":"mean(vec)","2":"2139"},{"1":"mean(vec)","2":"2216"},{"1":"mean(vec)","2":"2170"},{"1":"mean(vec)","2":"2175"},{"1":"mean(vec)","2":"2231"},{"1":"mean(vec)","2":"2205"},{"1":"mean(vec)","2":"2125"},{"1":"mean(vec)","2":"2273"},{"1":"mean(vec)","2":"2492"},{"1":"mean(vec)","2":"2176"},{"1":"mean(vec)","2":"2287"},{"1":"mean(vec)","2":"2207"},{"1":"mean(vec)","2":"2133"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>As you can see, there is some variability in runtime. This happens for a variety of reasons, but it doesn’t particularly matter for us. We are interested in how long things <strong>generally</strong> take to run in R, so we’ll compute some summary statistics. We can summarize the results using <code>summary(test_results)</code>.</p>
<pre class="r"><code>summary(test_results)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["expr"],"name":[1],"type":["fct"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["neval"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"mean(vec)","2":"2.119","3":"2.148","4":"3.7059","5":"2.1985","6":"2.2515","7":"148.922","8":"100"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The results here are in a dataframe, showing the expression run, along with its min, mean, median, upper and lower quartiles, and the number of times it was ran. You also get information about what unit the runtime was measured in. Here, it’s microseconds. In this case, the calculation is incredibly fast - the mean runtime was 3.7059 microseconds.</p>
<p>If you’re interested in more specifics of <code>microbenchmark()</code>, run <code>?microbenchmark</code> or <code>help("microbenchmark")</code> in your RStudio console. There are a number of optional arguments to the <code>microbenchmark()</code> function, including <code>times</code>, which specifies the number of times to evaluate the expression, and <code>unit</code>, the unit of measurement for the runtime.</p>
</div>
<div id="section-using-microbenchmark-to-compare-code" class="section level3">
<h3>using <code>microbenchmark</code> to compare code</h3>
<p><code>microbenchmark's</code> real power comes from its ability to compare different expressions in R. Let’s see if the R function <code>mean()</code> is faster than computing it ourselves using the <code>sum()</code> and <code>length()</code> functions.</p>
<pre class="r"><code>test_results_2 &lt;- microbenchmark(
  &#39;mean()&#39;=mean(vec),
  &#39;sum()&amp;length()&#39;=sum(vec)/length(vec)
)
summary(test_results_2)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["expr"],"name":[1],"type":["fct"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["neval"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"mean()","2":"2189","3":"2254","4":"2554.27","5":"2315.5","6":"2522.5","7":"17548","8":"100"},{"1":"sum()&length()","2":"582","3":"605","4":"806.90","5":"622.5","6":"642.5","7":"17053","8":"100"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Here, the results are in nanoseconds. It turns out that using <code>sum()</code> and <code>length()</code> is actually faster than <code>mean()</code>. However, with a difference as trivial as 1747.37 nanoseconds, it’s probably best to use the simple convenience function <code>mean()</code>.</p>
</div>
<div id="section-plotting-results" class="section level3">
<h3>Plotting results</h3>
<p>You can even plot the results quite easily, using the <code>autoplot()</code> function from <code>ggplot2</code>, which automatically draws the plot that works best with the class of object it is given (in this case, it makes a violin plot).</p>
<pre class="r"><code>autoplot(test_results_2)</code></pre>
<p><img src="601_Vectorization-Benchmarking_files/figure-html/autoplot%20results-1.png" width="624" /></p>
<p>Calculating a mean of 100 numbers is a computationally trivial thing to do. However, not all the code you write will be doing something so simple. Next, we will learn how for loops and vectorization compare, and then measure the differences using <code>microbenchmark</code>.</p>
</div>
<div id="section-exercise-1" class="section level3">
<h3>Exercise 1</h3>
<p>Below we create a numeric vector, called <code>vector_1</code>.</p>
<pre class="r"><code>vector_1 &lt;- c(5,4,3,1,6,4,3,2,6,4,2,1,5,6,7,3,2,9,5,8,9)</code></pre>
<p>Standardize the vector by subtracting the mean of <code>vector_1</code> from each score and then dividing by <code>vector_1</code>’s standard deviation. Then, use <code>microbenchmark()</code> to measure the computation time in <strong>seconds</strong>, and plot your results.</p>
<div class="tutorial-exercise" data-label="microbenchmark_exercise" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>#standardize vector_1 and use microbenchmark() to measure the computation time.</code></pre>
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.timelimit":10,"exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="microbenchmark_exercise-solution" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>vector_1_stdize &lt;- (vector_1-mean(vector_1))/sd(vector_1)
results &lt;- microbenchmark(
  &#39;standardize&#39;= vector_1_stdize &lt;- (vector_1-mean(vector_1))/sd(vector_1),
  unit=&#39;s&#39;
)
autoplot(results)</code></pre>
</div>
</div>
</div>
<div id="section-for-loop-review" class="section level2">
<h2><strong>For loop review</strong></h2>
<p>Let’s start off with a review of for loops. To do so, we’re going to use the <code>flights</code> dataset.</p>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["year"],"name":[1],"type":["int"],"align":["right"]},{"label":["month"],"name":[2],"type":["int"],"align":["right"]},{"label":["day"],"name":[3],"type":["int"],"align":["right"]},{"label":["dep_time"],"name":[4],"type":["int"],"align":["right"]},{"label":["sched_dep_time"],"name":[5],"type":["int"],"align":["right"]},{"label":["dep_delay"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["arr_time"],"name":[7],"type":["int"],"align":["right"]},{"label":["sched_arr_time"],"name":[8],"type":["int"],"align":["right"]},{"label":["arr_delay"],"name":[9],"type":["dbl"],"align":["right"]},{"label":["carrier"],"name":[10],"type":["chr"],"align":["left"]},{"label":["flight"],"name":[11],"type":["int"],"align":["right"]},{"label":["tailnum"],"name":[12],"type":["chr"],"align":["left"]},{"label":["origin"],"name":[13],"type":["chr"],"align":["left"]},{"label":["dest"],"name":[14],"type":["chr"],"align":["left"]},{"label":["air_time"],"name":[15],"type":["dbl"],"align":["right"]},{"label":["distance"],"name":[16],"type":["dbl"],"align":["right"]},{"label":["hour"],"name":[17],"type":["dbl"],"align":["right"]},{"label":["minute"],"name":[18],"type":["dbl"],"align":["right"]},{"label":["time_hour"],"name":[19],"type":["dttm"],"align":["right"]}],"data":[{"1":"2013","2":"1","3":"1","4":"517","5":"515","6":"2","7":"830","8":"819","9":"11","10":"UA","11":"1545","12":"N14228","13":"EWR","14":"IAH","15":"227","16":"1400","17":"5","18":"15","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"533","5":"529","6":"4","7":"850","8":"830","9":"20","10":"UA","11":"1714","12":"N24211","13":"LGA","14":"IAH","15":"227","16":"1416","17":"5","18":"29","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"542","5":"540","6":"2","7":"923","8":"850","9":"33","10":"AA","11":"1141","12":"N619AA","13":"JFK","14":"MIA","15":"160","16":"1089","17":"5","18":"40","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"544","5":"545","6":"-1","7":"1004","8":"1022","9":"-18","10":"B6","11":"725","12":"N804JB","13":"JFK","14":"BQN","15":"183","16":"1576","17":"5","18":"45","19":"2013-01-01 05:00:00"},{"1":"2013","2":"1","3":"1","4":"554","5":"600","6":"-6","7":"812","8":"837","9":"-25","10":"DL","11":"461","12":"N668DN","13":"LGA","14":"ATL","15":"116","16":"762","17":"6","18":"0","19":"2013-01-01 06:00:00"},{"1":"2013","2":"1","3":"1","4":"554","5":"558","6":"-4","7":"740","8":"728","9":"12","10":"UA","11":"1696","12":"N39463","13":"EWR","14":"ORD","15":"150","16":"719","17":"5","18":"58","19":"2013-01-01 05:00:00"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>In this dataset, each row is an individual flight out of New York City. The column <code>dep_delay</code> contains the difference between the scheduled departure and the actual departure time, but in minutes. Now let’s say we wanted to convert that to hours. To do so, we would divide each value in <code>dep_delay</code> by 60. We can do that using a <code>for</code> loop, and store the results in a vector.</p>
<p>First, we store all the departure delays in minutes, in a vector called <code>delays_mins</code>(making sure to remove <code>NA</code> values for when a delay was not available). The number of delays is calculated using the <code>length</code> function, and is stored as <code>n_delays</code>. Then, we create the vector <code>delays_hours_loop</code> to store the results of our computation, and the <code>mins_to_hours()</code> function to actually compute the results.</p>
<pre class="r"><code>delays_mins &lt;- !is.na(flights$dep_delay) #for simplicity, we remove NA values
n_delays &lt;- length(delays_mins) #number of delays will equal the length of the vector
delays_hours_loop &lt;- vector(&#39;numeric&#39;,n_delays) # to store our results
mins_to_hours &lt;- function(x) x/60 # custom function to convert minutes to hours
for(i in 1:n_delays){
  delays_hours_loop[i] &lt;- mins_to_hours(delays_mins[i])
}</code></pre>
<pre class="r"><code>head(delays_hours_loop)</code></pre>
<pre><code>## [1] 0.01666667 0.01666667 0.01666667 0.01666667 0.01666667 0.01666667</code></pre>
<p>The operation worked just fine, and the results are stored in <code>delays_hours_loop</code>. However, given that there are 336776 observations in this dataset, you may imagine that this many individual function calls can get computationally intensive. Though our current function is fairly simple, you may imagine that with more complex operations, the computation cost will add up fast. The next section will go through an alternative to for loops.</p>
</div>
<div id="section-vectorization" class="section level2">
<h2><strong>Vectorization</strong></h2>
<p>Rather than using a for loop, we can <strong>vectorize</strong> our conversion of minutes to hours function by applying it to all the elements in <code>delays_mins</code> simultaneously. This is called <strong>vectorizing</strong>. Doing so is fairly simple, and it’s often faster than a for loop.</p>
<p>We can use our previous example of converting flight delays to hours.</p>
<pre class="r"><code>delays_mins &lt;- !is.na(flights$dep_time) # remove all flights with NA dep_time
delays_hours &lt;- delays_mins/60 # convert mins to hours by dividing by 60</code></pre>
<p>Notice that here, we didn’t even have to write a function. We just performed the operation by dividing <code>delays_mins</code> by 60 (which automatically performs the division on each element of the vector, i.e. <strong>vectorizing</strong>). We could have called the <code>mins_to_hours()</code> function, but it’s not necessary to do so.</p>
<div id="section-comparing-vectorization-to-loops" class="section level3">
<h3>Comparing vectorization to loops</h3>
<p>Now that we know about for loops and vectorization, we can use <code>microbenchmark</code> to compare the two. We will use the same example, converting <code>delays_mins</code> to hours, using both methods.</p>
<pre class="r"><code>results_lv &lt;- microbenchmark(
  &#39;loop&#39;=for(i in 1:n_delays){
  delays_hours_loop[i] &lt;- mins_to_hours(delays_mins[i])
},
  &#39;vectorize&#39;=delays_hours_vectorize &lt;- delays_mins/60
)
summary(results_lv)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["expr"],"name":[1],"type":["fct"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["neval"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"loop","2":"158894.890","3":"169018.2","4":"173090.270","5":"171455.004","6":"174145.61","7":"253392.886","8":"100"},{"1":"vectorize","2":"825.623","3":"965.6","4":"1125.271","5":"1033.723","6":"1100.47","7":"2216.148","8":"100"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>autoplot(results_lv)</code></pre>
<p><img src="601_Vectorization-Benchmarking_files/figure-html/unnamed-chunk-2-1.png" width="624" /></p>
<p>Even ignoring the obvious the advantage of being simpler to read, vectorization is clearly faster than a for loop in this case.</p>
</div>
</div>
<div id="section-vectorization-using-the-apply-family-of-functions" class="section level2">
<h2><strong>Vectorization using the <code>apply</code> family of functions</strong></h2>
<p>Sometimes you have something more complicated, that can’t be performed in a single line of code. You can do it in a for loop, or you can use a function from the <code>apply</code> family to vectorize it.</p>
<p>To demonstrate the apply functions, let’s start out with a common example: Reading in data files.</p>
<p>It’s common to have to read in multiple data files in social science research. You may have an individual data file for each participant, and you need to combine them all into a single data frame in R.</p>
<p>First, we’ll use <code>list.files()</code> to store the names of all files in our current working directory to an object in R.</p>
<pre class="r"><code>files &lt;- list.files()
head(files)</code></pre>
<pre><code>## [1] &quot;1.csv&quot;  &quot;10.csv&quot; &quot;11.csv&quot; &quot;12.csv&quot; &quot;13.csv&quot; &quot;14.csv&quot;</code></pre>
<p>As you can see, we have a number of data files in our directory, all stored as files with a <code>.csv</code> extension.</p>
<p>We can use a for loop to read in all the data files, and save each one as a dataframe inside a list.</p>
<pre class="r"><code>data &lt;- vector(&#39;list&#39;,length(files)) #initialize list
for(i in 1:length(files)){
  data[[i]]&lt;-read_csv(files[[i]])
}</code></pre>
<p>Finally, we can use the <code>dplyr</code> function <code>bind_rows()</code> to bind all the dataframes into one, larger dataframe.</p>
<pre class="r"><code>dataset &lt;- data %&gt;%
  bind_rows()
glimpse(dataset)</code></pre>
<pre><code>## Rows: 2,000
## Columns: 5
## $ var1 &lt;dbl&gt; 0.26550866, 0.37212390, 0.57285336, 0.90820779, 0.20168193, 0.898…
## $ var2 &lt;dbl&gt; 16.54724, 13.53197, 12.70260, 19.92684, 16.33493, 12.13208, 11.29…
## $ var3 &lt;chr&gt; &quot;d&quot;, &quot;b&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, …
## $ var4 &lt;dbl&gt; 72.25094, 69.90720, 68.40966, 65.35319, 62.56270, 64.62404, 75.00…
## $ var5 &lt;chr&gt; &quot;orange&quot;, &quot;orange&quot;, &quot;orange&quot;, &quot;red&quot;, &quot;red&quot;, &quot;orange&quot;, &quot;orange&quot;, &quot;…</code></pre>
<p><strong>But wait!</strong> There’s a simpler (often faster) way to do it, using the <code>apply</code> family of functions.</p>
<p>There are several <code>apply</code> functions in R, including <code>lapply()</code>, <code>sapply()</code>, <code>vapply()</code>. They all work by taking an argument <code>X</code>, which is a data structure (e.g., vector) containing all the elements to apply a function to. The function is specified with the argument <code>FUN</code>.</p>
<div id="section-lapply" class="section level3">
<h3><code>lapply()</code></h3>
<p>There are some differences between the functions, so we’ll start out with (arguably) the most common version, <code>lapply()</code>. <code>lapply()</code> always returns data in the form of a list.</p>
<p>Below we use <code>lapply()</code> to use the <code>read_csv()</code> function on each element of <code>files</code>. We then use the <code>dplyr</code> function <code>bind_rows()</code> to combine the results into one larger dataframe, called <code>data1</code>.</p>
<pre class="r"><code>data1 &lt;- lapply(files, read_csv) %&gt;% 
  bind_rows()
glimpse(data1)</code></pre>
<pre><code>## Rows: 2,000
## Columns: 5
## $ var1 &lt;dbl&gt; 0.26550866, 0.37212390, 0.57285336, 0.90820779, 0.20168193, 0.898…
## $ var2 &lt;dbl&gt; 16.54724, 13.53197, 12.70260, 19.92684, 16.33493, 12.13208, 11.29…
## $ var3 &lt;chr&gt; &quot;d&quot;, &quot;b&quot;, &quot;a&quot;, &quot;b&quot;, &quot;b&quot;, &quot;b&quot;, &quot;c&quot;, &quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, &quot;c&quot;, …
## $ var4 &lt;dbl&gt; 72.25094, 69.90720, 68.40966, 65.35319, 62.56270, 64.62404, 75.00…
## $ var5 &lt;chr&gt; &quot;orange&quot;, &quot;orange&quot;, &quot;orange&quot;, &quot;red&quot;, &quot;red&quot;, &quot;orange&quot;, &quot;orange&quot;, &quot;…</code></pre>
<p>In the above code, lapply calls the <code>read_csv()</code> function once for each value <code>files</code>. Each time it calls <code>read_csv()</code>, it uses that particular value in <code>files</code> as input to the function.</p>
<p>Note that the results will be identical between the <code>for</code> loop and the <code>lapply</code> version.</p>
<p>However, the <code>lapply</code> version is both simpler to read and computationally faster (though the advantage is small). We can verify this using <code>microbenchmark</code>.</p>
<pre class="r"><code>files &lt;-list.files()
result &lt;- microbenchmark(
  &#39;loop&#39;=for(i in 1:length(files)){
    data[[i]]&lt;-read_csv(files[[i]])
  },
  &#39;lapply&#39;=data1 &lt;- lapply(files, read_csv),
  times = 50, # &#39;times&#39; is used to specify the number of times to run each chunk of code
  unit=&#39;s&#39; # &#39;unit&#39; specifies the unit of measurement we ask for (&#39;s&#39;=seconds)
)
summary(result)</code></pre>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["expr"],"name":[1],"type":["fct"],"align":["left"]},{"label":["min"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["lq"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["mean"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["median"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["uq"],"name":[6],"type":["dbl"],"align":["right"]},{"label":["max"],"name":[7],"type":["dbl"],"align":["right"]},{"label":["neval"],"name":[8],"type":["dbl"],"align":["right"]}],"data":[{"1":"loop","2":"0.9441472","3":"0.9747371","4":"1.010254","5":"1.008839","6":"1.042432","7":"1.094211","8":"50"},{"1":"lapply","2":"0.9246629","3":"0.9689664","4":"1.009044","5":"0.986852","6":"1.036820","7":"1.256837","8":"50"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<pre class="r"><code>autoplot(result)</code></pre>
<p><img src="601_Vectorization-Benchmarking_files/figure-html/compare%20for%20loop%20to%20lapply-1.png" width="624" /></p>
</div>
</div>
<div id="section-other-apply-functions" class="section level2">
<h2><strong>Other apply functions</strong></h2>
<p>There’s other apply functions, too. We will briefly go into discussion of a few helpful versions - <code>sapply()</code> and <code>vapply()</code></p>
<div id="section-sapply" class="section level3">
<h3><code>sapply()</code></h3>
<p><code>sapply()</code> is very similar to <code>lapply()</code>, except that it attempts to simplify the result to an atomic vector if possible (whereas <code>lapply()</code> always returns a list). Observe the difference below, when we use a trivial example with a custom function that multiplies its input by 3.</p>
<pre class="r"><code>triple &lt;- function(x) x*3
x &lt;- seq(0,10)
result_lapply &lt;- lapply(x, triple)
result_sapply &lt;- sapply(x, triple)
head(result_lapply)</code></pre>
<pre><code>## [[1]]
## [1] 0
## 
## [[2]]
## [1] 3
## 
## [[3]]
## [1] 6
## 
## [[4]]
## [1] 9
## 
## [[5]]
## [1] 12
## 
## [[6]]
## [1] 15</code></pre>
<pre class="r"><code>head(result_sapply)</code></pre>
<pre><code>## [1]  0  3  6  9 12 15</code></pre>
<p>As you can see, <code>lapply()</code> returns a list, whereas <code>sapply()</code> was able to simplify the result to an atomic vector.</p>
</div>
<div id="section-vapply" class="section level3">
<h3><code>vapply()</code></h3>
<p><code>vapply()</code> is similar to <code>sapply</code>, though it requires a third argument, <code>FUN.VALUE</code>, where the user must specify the format that they expect the results to be in.</p>
<p>Below, we use <code>numeric(1)</code> to tell <code>vapply()</code> that each time we call the function (that is, for each element of <code>x</code>) we expect a <code>numeric</code> result of length <code>1</code>. <code>vapply()</code> ensures that if the computation does not work as we intended, we will not get a result, forcing us to look at our code once more to ensure that it works as we intended.</p>
<pre class="r"><code>vapply(x, triple, numeric(1))</code></pre>
<pre><code>##  [1]  0  3  6  9 12 15 18 21 24 27 30</code></pre>
</div>
<div id="section-exercise" class="section level3">
<h3>Exercise</h3>
<p>Below we create a numeric vector, called <code>vector_3</code>.</p>
<pre class="r"><code>vector_3 &lt;- round(rnorm(50,mean=30,sd=5))</code></pre>
<p>Write a function that takes a single input, <code>x</code>. The function squares <code>x</code> and then adds 1 to the result. Then, apply the function to each element of vector 3, once using <code>lapply()</code> and once using <code>sapply()</code>.</p>
<div class="tutorial-exercise" data-label="lapply" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.timelimit":10,"exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="lapply-solution" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>function_1 &lt;- function(x) x^2+1
lapply(vector_3, function_1)
sapply(vector_3, function_1)</code></pre>
</div>
</div>
</div>
<div id="section-purrr" class="section level2">
<h2><strong><code>purrr</code></strong></h2>
<p>In addition to the <code>apply</code> functions already included in R, there’s a powerful package created to enhance your R vectorization: the <code>purrr</code> package, which is part of the tidyverse (see <a href="https://purrr.tidyverse.org/">this link</a> to learn more).</p>
<p>To install <code>purrr</code>, simply run the following code:</p>
<pre class="r"><code>install.packages(&quot;purrr&quot;)</code></pre>
<p><code>purrr</code> is a powerful package containing a number of functions, and thus learning all of <code>purrr</code> is well beyond the scope of the present tutorial.</p>
<p>With that being said, we will be going over a few helpful <code>purrr</code> functions that can be beneficial for those trying to vectorize code.</p>
<div id="section-map" class="section level3">
<h3><code>map()</code></h3>
<p><code>map()</code> allows us to vectorize a function - that is, <a href="https://purrr.tidyverse.org/reference/map.html">“apply it to each element of a list or vector”</a>.</p>
<p>The first argument <code>map()</code> takes, <code>.x</code>, is the vector or list we wish to apply the function to. The second argument, <code>.f</code>, is the function we’re using. Let’s try an example.</p>
<p>First, we create a vector of integers from 1 to 100, <code>vector_2</code>. Next, we are going to use <code>map()</code> to take 100 random samples (of 50 values) from a normal distribution with a standard deviation of 5. Importantly, <strong>each sample has a different mean, which is specified by each element of <code>vector_2</code></strong>. The first time <code>rnorm()</code> runs, it will take 50 random samples with a mean of 1 (the <strong>first</strong> element of <code>vector_2</code>). The second time <code>rnorm()</code> runs, it will take 50 random samples with mean of 2 (the <strong>second</strong> element of <code>vector_2</code>). All in all, we will get a list of 100 elements, with each element containing 50 numbers sampled from a normal distribution with the mean equal to the list index. For example, the <em>23rd</em> list element will contain 50 values randomly sampled from a normal distribution with a mean of <em>23</em> and a standard deviation of 5. We specify <code>n</code> and <code>sd</code> in subsequent arguments.</p>
<pre class="r"><code>vector_2 &lt;- seq(1,100) # sequence of integers from 1 to 100
map_results &lt;- map(vector_2, rnorm,n=50, sd=5) # run rnorm() using each element of the vector as the &quot;mean&quot; argument
str(map_results)</code></pre>
<pre><code>## List of 100
##  $ : num [1:50] 4.191 -3.941 2.121 9.799 0.602 ...
##  $ : num [1:50] 3.3228 0.0617 -9.5605 2.4401 3.8654 ...
##  $ : num [1:50] -5.88 1.32 5.66 3.56 5.83 ...
##  $ : num [1:50] 1.78 7.25 10.8 9.86 7.53 ...
##  $ : num [1:50] 5.93 9.65 2.06 1.33 9.1 ...
##  $ : num [1:50] -0.631 1.472 18.288 6.474 4.996 ...
##  $ : num [1:50] 0.238 11.347 2.793 -0.532 -3.342 ...
##  $ : num [1:50] -1.77 7.56 15.26 13.91 3.26 ...
##  $ : num [1:50] 7.78 3.36 13.71 14.03 9.68 ...
##  $ : num [1:50] -3.98 11.63 13.1 7.78 6.2 ...
##  $ : num [1:50] 3.36 3.42 5.71 5.41 11.32 ...
##  $ : num [1:50] 8.62 15.22 18.88 11.27 12.66 ...
##  $ : num [1:50] 18.7 15.6 19.8 11 16.8 ...
##  $ : num [1:50] 7.74 5.53 18.85 21.77 2.98 ...
##  $ : num [1:50] 19.27 16.64 22.56 3.06 8.28 ...
##  $ : num [1:50] 20.9 17.8 26.6 11.3 16.2 ...
##  $ : num [1:50] 13.1 18.2 20.7 20.6 26 ...
##  $ : num [1:50] 19.7 9.3 15.5 15.8 16.5 ...
##  $ : num [1:50] 16.5 23.2 19.8 17.7 24.3 ...
##  $ : num [1:50] 21.6 23.3 24.5 22.4 28.2 ...
##  $ : num [1:50] 21.7 25.7 16 22.6 18.9 ...
##  $ : num [1:50] 27.4 17.3 21.9 17.8 11.6 ...
##  $ : num [1:50] 18.4 24.7 25.3 32.4 27.2 ...
##  $ : num [1:50] 25.2 20.8 17.7 21.7 25.6 ...
##  $ : num [1:50] 24.3 26.8 32.6 29 26.9 ...
##  $ : num [1:50] 31.7 33 17.6 28 22.3 ...
##  $ : num [1:50] 21.3 11.4 20 25.4 21.4 ...
##  $ : num [1:50] 32 22 37.3 25 32.2 ...
##  $ : num [1:50] 39.5 38.5 30.1 30.3 32.1 ...
##  $ : num [1:50] 37.4 27.2 35.8 33.5 38.1 ...
##  $ : num [1:50] 32.4 17.7 25.8 33.6 25.5 ...
##  $ : num [1:50] 30.2 34.1 32.2 24.6 28.3 ...
##  $ : num [1:50] 41.4 26.1 27.3 27.7 34.4 ...
##  $ : num [1:50] 31.3 41 35.7 33.7 43.4 ...
##  $ : num [1:50] 39.9 39 27.8 30 29.3 ...
##  $ : num [1:50] 30.3 43.9 37.7 41 38.4 ...
##  $ : num [1:50] 45.5 33.7 34.5 34.8 31.6 ...
##  $ : num [1:50] 42.2 38.2 33.5 39.8 34.1 ...
##  $ : num [1:50] 38.7 35 48.4 46.7 32.8 ...
##  $ : num [1:50] 40.8 41.9 40 37.8 39.1 ...
##  $ : num [1:50] 39.5 37 43.5 39.7 40.1 ...
##  $ : num [1:50] 40.2 46.2 53 41.9 40.5 ...
##  $ : num [1:50] 47.9 38.3 32.8 34.7 45.3 ...
##  $ : num [1:50] 49.6 38.7 35.7 40.6 48.5 ...
##  $ : num [1:50] 41 50.7 42.3 46.8 42.9 ...
##  $ : num [1:50] 43.1 37.8 43.7 55.3 45.7 ...
##  $ : num [1:50] 43.5 46.5 54.6 45.2 51.1 ...
##  $ : num [1:50] 45.6 54.4 43.9 52.6 51.4 ...
##  $ : num [1:50] 49.7 53.1 47.6 46.6 45.2 ...
##  $ : num [1:50] 46 47.3 48.1 46.8 46.6 ...
##  $ : num [1:50] 49.5 44.9 47.1 53.9 48.4 ...
##  $ : num [1:50] 54.1 47.5 54 55.5 59.7 ...
##  $ : num [1:50] 61.1 58.1 56.9 50.9 59.1 ...
##  $ : num [1:50] 60.5 47.2 60.6 59.1 49.8 ...
##  $ : num [1:50] 54.2 55.6 46.7 56.5 52 ...
##  $ : num [1:50] 64.4 57.9 56 52.1 57.4 ...
##  $ : num [1:50] 64.3 56.1 57.8 58.3 52.3 ...
##  $ : num [1:50] 57.8 55.5 55 57.6 63.5 ...
##  $ : num [1:50] 55.2 55.2 51 62.7 61.2 ...
##  $ : num [1:50] 46.8 56 56 57.4 63.2 ...
##  $ : num [1:50] 54.4 53.9 60.7 60 61.3 ...
##  $ : num [1:50] 64 57.8 74.1 60.5 63.6 ...
##  $ : num [1:50] 64.9 64.6 59.8 61.7 67.8 ...
##  $ : num [1:50] 68.2 70.8 59.4 56.5 63.4 ...
##  $ : num [1:50] 53.4 64.6 62.2 59 79.7 ...
##  $ : num [1:50] 60.6 64.1 69 67.1 61.2 ...
##  $ : num [1:50] 59.3 69.6 64.1 70.5 63 ...
##  $ : num [1:50] 73.5 81.5 75.7 71 71.5 ...
##  $ : num [1:50] 67.8 68.4 77 61 70 ...
##  $ : num [1:50] 64.4 66.1 58.6 64 64.4 ...
##  $ : num [1:50] 82 74.1 62.6 73.4 78.2 ...
##  $ : num [1:50] 71.6 76.8 76.5 73.3 66.2 ...
##  $ : num [1:50] 71.5 75.8 77.3 69.5 74.2 ...
##  $ : num [1:50] 73.8 82.4 72.4 68.4 78.9 ...
##  $ : num [1:50] 75.3 72.6 68.9 81.1 71.1 ...
##  $ : num [1:50] 73.3 71.9 77.1 73.2 77 ...
##  $ : num [1:50] 70.6 83.1 78.8 79.4 76.1 ...
##  $ : num [1:50] 63.3 72.1 78.3 80.8 82.2 ...
##  $ : num [1:50] 73.8 79 76.5 69.7 72.8 ...
##  $ : num [1:50] 88.2 72.4 76.1 79.2 70.5 ...
##  $ : num [1:50] 85.1 78.4 79.5 85.2 83.2 ...
##  $ : num [1:50] 76.2 75.7 75.5 83.3 78.5 ...
##  $ : num [1:50] 74.4 75 84.9 83.6 89.1 ...
##  $ : num [1:50] 78.1 79.6 85.1 88.7 84.7 ...
##  $ : num [1:50] 81.9 91 90.4 89.2 78.5 ...
##  $ : num [1:50] 82.3 86.5 79.1 79 80 ...
##  $ : num [1:50] 87.9 86.2 87.6 88.9 89 ...
##  $ : num [1:50] 91.8 80.9 101 90.5 88.3 ...
##  $ : num [1:50] 87.3 87.5 81.7 92.7 86.5 ...
##  $ : num [1:50] 93.6 82.9 100.3 91.9 84.8 ...
##  $ : num [1:50] 90.7 87.8 83.3 94 88.9 ...
##  $ : num [1:50] 84.5 91 107 96.6 93.9 ...
##  $ : num [1:50] 95.1 104.1 93.5 88.7 95.1 ...
##  $ : num [1:50] 100.3 94.6 89.6 99.3 86.4 ...
##  $ : num [1:50] 85.4 96.2 91.2 102.3 97.2 ...
##  $ : num [1:50] 94.9 91.9 91.8 101.4 96.4 ...
##  $ : num [1:50] 102.6 103.1 93.8 101.8 92.7 ...
##  $ : num [1:50] 105.5 94 99.8 97.2 92.1 ...
##  $ : num [1:50] 101.9 100.7 94.2 101.9 101.5 ...
##   [list output truncated]</code></pre>
<p>We store our results in an object called <code>map_results</code>. We use <code>str()</code> to view the structure of the object, which is a list of 100 elements, each of which is a vector containing 50 values.</p>
</div>
<div id="section-map2" class="section level3">
<h3><code>map2()</code></h3>
<p>Suppose we have two vectors, <code>means_vector</code> and <code>sd_vector</code>, each of which contains 100 values. We want to take 100 samples from a normal distribution, each with 50 values, with each mean equal to the ith element of <code>means_vector</code> and the standard deviation equal to the ith element of <code>sd_vector</code>. This may sound complicated, but we can actually do it rather simply using the <code>purrr</code> function <code>map2()</code>. See the code below for a demonstration.</p>
<p><code>map2()</code> takes the arguments <code>.x</code> (the first vector or list), <code>.y</code> (the second vector or list), <code>.f</code> (the function to apply), and any additional arguments to pass to <code>.f</code> with <code>...</code>.</p>
<p>First, we create a vector containing each individual mean we want to use for sampling, <code>means_vector</code>. Next, we create a vector containing each individual standard deviation we want to use for sampling, <code>sd_vector</code>. These are both vectors containing integers from 1 to 100.</p>
<p>Next, we specify the first vector given to <code>map2()</code>, <code>means_vector</code>. We then specify the second vector given to <code>map2()</code>, <code>sd_vector</code>. Next, we specify the function we are vectorizing, in this case, <code>rnorm()</code>. Lastly, we will also need to tell <code>rnorm()</code> how many values to sample each time, so we specify <code>n=50</code>.</p>
<p>This line of code will create 100 samples, each with 50 values. The first sample comes from a normal distribution with a mean of <code>means_vector[1]</code> and a standard deviation of <code>sd_vector[1]</code>. The second sample comes from a normal distribution with a mean of <code>means_vector[2]</code> and a standard deviation of <code>sd_vector[2]</code>…and so on. These samples are stored in a list as <code>map2_results</code>, and we use <code>str()</code> to view the structure of this object.</p>
<pre class="r"><code>means_vector &lt;- seq(1,100)
sd_vector &lt;- seq(1,100)
map2_results &lt;- map2(means_vector, sd_vector, rnorm, n=50)
str(map2_results)</code></pre>
<pre><code>## List of 100
##  $ : num [1:50] 0.6407 0.4426 -0.0891 0.0986 1.414 ...
##  $ : num [1:50] -0.0151 3.193 -2.1422 0.2657 1.9328 ...
##  $ : num [1:50] 6.99 9.53 2.4 1.55 6.84 ...
##  $ : num [1:50] 3.24 3.296 6.064 10.953 -0.566 ...
##  $ : num [1:50] 0.625 12.786 -0.227 2.665 9.965 ...
##  $ : num [1:50] 5.68 22.73 7.72 8.89 -5.19 ...
##  $ : num [1:50] 5.384 0.125 -0.929 5.94 14.55 ...
##  $ : num [1:50] 11.34 22.45 12.65 14.76 -5.41 ...
##  $ : num [1:50] 22.97 17.41 -7.69 16.43 -1.1 ...
##  $ : num [1:50] -16.26 12.47 28.87 9.52 20.66 ...
##  $ : num [1:50] 25.8 -6.98 41.96 3.35 16.81 ...
##  $ : num [1:50] 8.49 16 33.56 23.21 17.07 ...
##  $ : num [1:50] 6.51 23.2 19.01 4.11 24.62 ...
##  $ : num [1:50] 4.956 24.98 2.017 40.982 -0.348 ...
##  $ : num [1:50] 35.53 -12.04 24.61 7.4 -4.11 ...
##  $ : num [1:50] 10.7 34.6 15 15.2 32 ...
##  $ : num [1:50] 13.34 21.83 -30.89 2.91 17.28 ...
##  $ : num [1:50] 41.6 6.48 3.47 27.25 21.12 ...
##  $ : num [1:50] 23.26 9.39 43.58 -1.28 9.57 ...
##  $ : num [1:50] 22.9 3.1 72.3 17.9 30.7 ...
##  $ : num [1:50] 23.7 16.2 23.9 22.3 46.1 ...
##  $ : num [1:50] -8.995 20.184 28.095 -0.174 -3.44 ...
##  $ : num [1:50] 64.6 50.28 74.64 18.58 2.33 ...
##  $ : num [1:50] 12.65 3.26 55.39 6.89 51.83 ...
##  $ : num [1:50] 32.2 28.3 -39.4 35.7 29.3 ...
##  $ : num [1:50] -10.5 19.9 43.3 52.1 56.1 ...
##  $ : num [1:50] 60.459 37.558 -17.711 0.334 8.672 ...
##  $ : num [1:50] 40.55 -5.51 11.01 66.6 -4.2 ...
##  $ : num [1:50] -20.6 65.5 27.1 9.8 16.4 ...
##  $ : num [1:50] 15.6 35.8 77.4 5.2 10.9 ...
##  $ : num [1:50] 32.6 28.5 -47.2 64.4 83 ...
##  $ : num [1:50] 81.42 55.06 7.04 17.47 10.33 ...
##  $ : num [1:50] 88.6 22.6 52.8 -42.4 12 ...
##  $ : num [1:50] 31.97 -4.22 92.82 13.71 -4.15 ...
##  $ : num [1:50] -34.76 32.42 66.6 59.14 9.82 ...
##  $ : num [1:50] -22.836 24.538 -14.067 58.152 0.286 ...
##  $ : num [1:50] 25.5 65.7 34.8 66.3 41.3 ...
##  $ : num [1:50] 26.2 37.3 99.2 71.2 15.3 ...
##  $ : num [1:50] 70.6 -16.3 -56.9 -16.1 74.1 ...
##  $ : num [1:50] 75.9 -24.3 46 18.5 148.4 ...
##  $ : num [1:50] 57.3 108 138.5 60.6 59.3 ...
##  $ : num [1:50] 26.63 65.24 56.04 13.09 -2.73 ...
##  $ : num [1:50] 28.8 40.7 37.7 76.7 24.9 ...
##  $ : num [1:50] 122.4 52.1 54.5 70.9 12.4 ...
##  $ : num [1:50] 61.1 39.2 159.5 22.9 108.7 ...
##  $ : num [1:50] 12.63 62.92 41.922 0.164 -8.292 ...
##  $ : num [1:50] -1.691 -0.645 17.774 75.641 142.317 ...
##  $ : num [1:50] -31.5 109.4 88.4 103.2 111.9 ...
##  $ : num [1:50] 94.6 69.7 95.9 24.8 57.5 ...
##  $ : num [1:50] 43.9 63 111.3 13.1 171.1 ...
##  $ : num [1:50] 62.6 78.5 -53 99.7 21.3 ...
##  $ : num [1:50] 33.95 2.98 37.99 69.69 28.38 ...
##  $ : num [1:50] 41.3 -57.6 25.7 -64.5 23.6 ...
##  $ : num [1:50] 52.2 101.5 24.8 82.7 95.6 ...
##  $ : num [1:50] 9.77 75.6 40.67 62.73 68.82 ...
##  $ : num [1:50] 66.4 45.7 127 28.3 47.3 ...
##  $ : num [1:50] 30.78 74.16 92.23 -28.6 8.71 ...
##  $ : num [1:50] 211 21.9 173.6 81.4 29 ...
##  $ : num [1:50] 185.57 111.02 -7.56 24.77 -3.12 ...
##  $ : num [1:50] 57.73 -5.02 81.42 20.6 182.39 ...
##  $ : num [1:50] 71.5 53.1 93.3 -12.4 89.6 ...
##  $ : num [1:50] 24 68.3 54.6 216.3 101.7 ...
##  $ : num [1:50] 75.1 99 39.1 35.7 58 ...
##  $ : num [1:50] 44.6 -22.5 -20.3 75.6 82 ...
##  $ : num [1:50] 23.1 86 11.3 43.4 10.7 ...
##  $ : num [1:50] 178 75.7 211.5 61.5 147.8 ...
##  $ : num [1:50] 116.9 129.2 77.5 -21.9 77.8 ...
##  $ : num [1:50] 85 43.9 78.04 1.52 115.84 ...
##  $ : num [1:50] 50.4 116.8 79 -32.6 56.5 ...
##  $ : num [1:50] 68.42 149.6 88.7 66.76 -3.79 ...
##  $ : num [1:50] 82.4 41 143.8 -90.6 -10 ...
##  $ : num [1:50] 86.39 25.52 162.04 -7.54 41.91 ...
##  $ : num [1:50] 57.1 157.3 135.5 75.7 97.5 ...
##  $ : num [1:50] 30.8 96.6 18.5 91.3 87.9 ...
##  $ : num [1:50] 38.56 46.85 30.29 160.63 -1.77 ...
##  $ : num [1:50] 60.8 16 -17.8 119.2 29.6 ...
##  $ : num [1:50] 98.7 135.7 117.8 46.8 102.7 ...
##  $ : num [1:50] 18.6 -20.3 55.2 94.1 83.5 ...
##  $ : num [1:50] -57.6 47.3 161.5 70.9 30.1 ...
##  $ : num [1:50] 107.9 54.1 62 50.3 218.9 ...
##  $ : num [1:50] 26 82.1 -71.7 156.4 89.2 ...
##  $ : num [1:50] 88.55 -42.35 49.35 82.38 9.56 ...
##  $ : num [1:50] 15.8 76.1 18.2 50.8 142.1 ...
##  $ : num [1:50] 87 57.5 169.5 62.1 -60.3 ...
##  $ : num [1:50] 217.7 143.5 175.8 80.9 111.6 ...
##  $ : num [1:50] -21.6 34.7 156.6 112.6 120.9 ...
##  $ : num [1:50] 186 125.4 153.8 35.3 71.7 ...
##  $ : num [1:50] 65.9 268.6 37 63.8 -55.2 ...
##  $ : num [1:50] 19.2 95.3 12.3 210.5 60.9 ...
##  $ : num [1:50] 295 163 102 154 221 ...
##  $ : num [1:50] 182.7 64 124.9 50.2 51.1 ...
##  $ : num [1:50] -13.6 110.8 95 93.9 267.2 ...
##  $ : num [1:50] 104.9 180.4 150.5 -72.3 91.5 ...
##  $ : num [1:50] 122.74 189.31 -146.2 138.79 3.52 ...
##  $ : num [1:50] 45.7 172 172.9 166.5 43.1 ...
##  $ : num [1:50] 102 189 303 190 12 ...
##  $ : num [1:50] -23.1 155.3 30.4 -53.9 90.6 ...
##  $ : num [1:50] 54.2 32.2 204.8 81.6 249.8 ...
##  $ : num [1:50] -63.22 -5.84 168.58 114.68 64.55 ...
##   [list output truncated]</code></pre>
</div>
<div id="section-pmap" class="section level3">
<h3><code>pmap()</code></h3>
<p>What if we have 3, 4, or 5 vectors we want to apply a function to? Rather than a map3 or map4, <code>purrr</code> has a function called <code>pmap()</code>, for when you need to vectorize a function and have more than 2 vectors/lists.</p>
<p><code>pmap()</code> takes the arguments <code>.l</code> (a list of vectors/lists), <code>.f</code> (the function to apply), and any additional arguments to pass to <code>.f</code> with <code>...</code>.</p>
<p>Below, we create three vectors: <code>means_vector</code>, <code>sd_vector</code>, and <code>n_vector</code>. We are again going to get 100 random samples from a normal distribution. This time, <code>n</code> is also vectorized.</p>
<p>Next, we specify the first vector given to <code>pmap()</code>, <code>n_vector</code>. Note that we need to order our vectors in the order we want to give them to rnorm (that is, <code>n</code>, then <code>mean</code>, then <code>sd</code>), as well as wrap them all in a list. We then specify the second vector given to <code>pmap()</code>, <code>means_vector</code>. We then specify the third vector given to <code>pmap()</code>, <code>sd_vector</code>. Last, we specify the function we are vectorizing, in this case, <code>rnorm()</code>.</p>
<p>This line of code will create 100 samples, each with 50 values. The first sample comes from a normal distribution with a mean of <code>means_vector[1]</code> and a standard deviation of <code>sd_vector[1]</code>, and contains <code>n_vector[1]</code> values. The second sample comes from a normal distribution with a mean of <code>means_vector[2]</code> and a standard deviation of <code>sd_vector[2]</code>, and contains <code>n_vector[2]</code> values…and so on. These samples are stored in a list as <code>map2_results</code>, and we use <code>str()</code> to view the structure of this object.</p>
<pre class="r"><code>means_vector &lt;- seq(1,100)
sd_vector &lt;- seq(1,100)
n_vector &lt;- seq(1,100)
pmap_results &lt;- pmap(list(n=n_vector, mean=means_vector,sd=sd_vector),rnorm)</code></pre>
</div>
<div id="section-exercise-2" class="section level3">
<h3>Exercise</h3>
<p>Using <code>sum()</code> and <code>pmap()</code>, add the ith elements of each of the three vectors <code>vec_1</code>, <code>vec_2</code>, <code>vec_3</code>. Store the results in an object called <code>vector_sum</code>. Then examine the object. Do the results look like you anticipated?</p>
<pre class="r"><code>vec_1 &lt;- round(runif(50,min=0,max=10))
vec_2 &lt;- round(runif(50,min=10,max=20))
vec_3 &lt;- round(runif(50,min=20,max=30))</code></pre>
<div class="tutorial-exercise" data-label="pmap_exercise" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<script type="application/json" data-opts-chunk="1">{"fig.width":6.5,"fig.height":4,"fig.retina":2,"fig.align":"default","fig.keep":"high","fig.show":"asis","out.width":624,"warning":true,"error":false,"message":true,"exercise.df_print":"paged","exercise.timelimit":10,"exercise.checker":"NULL"}</script>
</div>
<div class="tutorial-exercise-support" data-label="pmap_exercise-solution" data-caption="Code" data-completion="1" data-diagnostics="1" data-startover="1" data-lines="0">
<pre class="text"><code>vector_sum &lt;- pmap(list(vec_1, vec_2, vec_3),sum)
str(vector_sum)
# vector_sum should be a list of 50 elements, each of which contains a single value (sum of the ith element of vec_1, vec_2, vec_3)</code></pre>
</div>
</div>
</div>
<div id="section-conclusion" class="section level2">
<h2><strong>Conclusion</strong></h2>
You’ve now learned about vectorization and benchmarking, as well as an introduction to the powerful <code>purrr</code> package.<br />

<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
library(tidyverse)
library(nycflights13)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir=here::here('10_Vectorization&Benchmarking/prep/files'))
tutorial_options(exercise.timelimit = 10)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
learnr:::register_http_handlers(session, metadata = NULL)
</script>
 
<script type="application/shiny-prerendered" data-context="server">
session$onSessionEnded(function() {
        learnr:::session_stop_event(session)
      })
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-microbenchmark_exercise-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-microbenchmark_exercise-code-editor`)), session)
output$`tutorial-exercise-microbenchmark_exercise-output` <- renderUI({
  `tutorial-exercise-microbenchmark_exercise-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-lapply-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-lapply-code-editor`)), session)
output$`tutorial-exercise-lapply-output` <- renderUI({
  `tutorial-exercise-lapply-result`()
})
</script>
 
<script type="application/shiny-prerendered" data-context="server">
`tutorial-exercise-pmap_exercise-result` <- learnr:::setup_exercise_handler(reactive(req(input$`tutorial-exercise-pmap_exercise-code-editor`)), session)
output$`tutorial-exercise-pmap_exercise-output` <- renderUI({
  `tutorial-exercise-pmap_exercise-result`()
})
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["header-attrs"]},{"type":"character","attributes":{},"value":["2.10"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pandoc"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["header-attrs.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/cerulean.min.css"]},{"type":"character","attributes":{},"value":["<style>h1 {font-size: 34px;}\n       h1.title {font-size: 38px;}\n       h2 {font-size: 30px;}\n       h3 {font-size: 24px;}\n       h4 {font-size: 18px;}\n       h5 {font-size: 16px;}\n       h6 {font-size: 12px;}\n       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}\n       pre:not([class]) { background-color: white }<\/style>"]},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["pagedtable"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/pagedtable-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["js/pagedtable.js"]},{"type":"character","attributes":{},"value":["css/pagedtable.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["textmate.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-format"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmarkdown/templates/tutorial/resources"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-format.js"]},{"type":"character","attributes":{},"value":["tutorial-format.css","rstudio-theme.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["font-awesome"]},{"type":"character","attributes":{},"value":["5.1.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/fontawesome"]}]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["css/all.css","css/v4-shims.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.10"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootbox"]},{"type":"character","attributes":{},"value":["4.4.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/bootbox"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["bootbox.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["idb-keyvalue"]},{"type":"character","attributes":{},"value":["3.2.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/idb-keyval"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["idb-keyval-iife-compat.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[false]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial.js"]},{"type":"character","attributes":{},"value":["tutorial.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-autocompletion"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-autocompletion.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["tutorial-diagnostics"]},{"type":"character","attributes":{},"value":["0.10.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/tutorial"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tutorial-diagnostics.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["ace"]},{"type":"character","attributes":{},"value":["1.2.6"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/ace"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["ace.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["clipboardjs"]},{"type":"character","attributes":{},"value":["1.5.15"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["lib/clipboardjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["clipboard.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["learnr"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["0.10.1"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91]}},"value":[{"type":"character","attributes":{},"value":["assertthat","backports","base","bit","bit64","broom","bslib","cellranger","cli","colorspace","compiler","crayon","datasets","DBI","dbplyr","digest","dplyr","ellipsis","evaluate","fansi","farver","fastmap","forcats","fs","generics","ggplot2","glue","graphics","grDevices","grid","gtable","haven","here","highr","hms","htmltools","htmlwidgets","httpuv","httr","jquerylib","jsonlite","knitr","labeling","later","learnr","lifecycle","lubridate","magrittr","markdown","methods","microbenchmark","mime","modelr","munsell","nycflights13","parallel","pillar","pkgconfig","promises","purrr","R6","Rcpp","readr","readxl","reprex","rlang","rmarkdown","rprojroot","rstudioapi","rvest","sass","scales","shiny","stats","stringi","stringr","tibble","tidyr","tidyselect","tidyverse","tools","tzdb","utf8","utils","vctrs","vroom","withr","xfun","xml2","xtable","yaml"]},{"type":"character","attributes":{},"value":["0.2.1","1.2.1","4.1.0","4.0.4","4.0.5","0.7.7","0.2.5.1","1.1.0","3.0.1","2.0-1","4.1.0","1.4.1","4.1.0","1.1.1","2.1.1","0.6.27","1.0.6","0.3.2","0.14","0.5.0","2.1.0","1.1.0","0.5.1","1.5.0","0.1.0","3.3.4","1.4.2","4.1.0","4.1.0","4.1.0","0.3.0","2.4.1","1.0.1","0.9","1.1.0","0.5.1.1","1.5.3","1.6.1","1.4.2","0.1.4","1.7.2","1.33","0.4.2","1.2.0","0.10.1","1.0.0","1.7.10","2.0.1","1.1","4.1.0","1.4-7","0.11","0.1.8","0.5.0","1.0.2","4.1.0","1.6.2","2.0.3","1.2.0.1","0.3.4","2.5.1","1.0.7","2.0.1","1.3.1","2.0.0","0.4.11","2.10","2.0.2","0.13","1.0.0","0.4.0","1.1.1","1.6.0","4.1.0","1.7.3","1.4.0","3.1.3","1.1.3","1.1.1","1.3.1","4.1.0","0.1.2","1.2.2","4.1.0","0.3.8","1.5.4","2.4.2","0.25","1.3.2","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>

</div> <!-- topics -->

<div class="topicsContainer">
<div class="topicsPositioner">
<div class="band">
<div class="bandContent topicsListContainer">

<!-- begin doc-metadata -->
<div id="doc-metadata">
<h2 class="title toc-ignore" style="display:none;">Tutorial 10: ADVANCED - Vectorization &amp; Benchmarking</h2>
</div>
<!-- end doc-metadata -->

</div> <!-- bandContent.topicsListContainer -->
</div> <!-- band -->
</div> <!-- topicsPositioner -->
</div> <!-- topicsContainer -->


</div> <!-- bandContent page -->
</div> <!-- pageContent band -->




<script>
// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});
</script>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>


</body>

</html>
